<?xml version="1.0" encoding="UTF-8"?>

<query>
	<major>
		<getMajorGroupIdByMajorId>
			SELECT	MAJOR_GROUP_ID		
			FROM	MAJOR
			WHERE	MAJOR_ID = ?		
		</getMajorGroupIdByMajorId>
		<getMajorIdByMajorName>
			SELECT	MAJOR_ID		
			FROM	MAJOR
			WHERE	MAJOR_NAME = ? 
		</getMajorIdByMajorName>
		<checkMajorName>
			SELECT	MAJOR_ID
					, MAJOR_NAME
					, MAJOR_GROUP_ID					
			FROM	MAJOR
			WHERE	MAJOR_NAME LIKE '%' || ? || '%'		
		</checkMajorName>
	</major>
	<univ>
		<isExistStdUnivEmail>
			SELECT 	*
			FROM	MEMBER
			WHERE	EMAIL_ID = ?
		</isExistStdUnivEmail>
		<getUnivIdByUnivName>
			SELECT	UNIV_ID		
			FROM	UNIV
			WHERE	UNIV_NAME = ? 
		</getUnivIdByUnivName>
		<checkUnivName>
			SELECT	UNIV_ID
					, UNIV_NAME
			FROM	UNIV
			WHERE	UNIV_NAME LIKE '%' || ? || '%'			
		</checkUnivName>
	</univ>
	<mac>
		<getMacDescByStudentEmail>
			SELECT 	MAC_ID
					, STUDENT_EMAIL
					, MAC_DESC
			FROM	MAC
			WHERE	STUDENT_EMAIL = ?					
		</getMacDescByStudentEmail>
		
		<addMacInfo>
			INSERT INTO MAC (
						  		MAC_ID
						  		, STUDENT_EMAIL
						  		, MAC_DESC
						  	) 
			VALUES 			( 
								MAC_ID_SEQ.NEXTVAL
								,?
								,? 
							)
		</addMacInfo>
	</mac>
	<article>
		<minusLikeCount>
			UPDATE	ARTICLE
			SET		ARTICLE_LIKES = ARTICLE_LIKES - 1
			WHERE	ARTICLE_ID = ?
		</minusLikeCount>
		<plusLikeCount>
			UPDATE	ARTICLE
			SET		ARTICLE_LIKES = ARTICLE_LIKES + 1
			WHERE	ARTICLE_ID = ?
		</plusLikeCount>
		<getArticleLikes>
			SELECT	ARTICLE_LIKES
			FROM	ARTICLE
			WHERE	ARTICLE_ID = ?
		</getArticleLikes>
		<showMajorArticle>
        	SELECT		ARTICLE_ID
        				, ARTICLE_TITLE
						, ARTICLE_DESC
						, ARTICLE_MODIFY_DATE
						, AT.ARTICLE_TYPE_NAME
						, SM.NICK_NAME
						, BOARD_ID
						, A.MAJOR_GROUP_ID
						, HITS
						, ARTICLE_LIKES
						, ARTICLE_DISLIKES
			FROM 		ARTICLE A
						, STD_MEMBER SM
						, ARTICLE_TYPE AT
			WHERE	    A.STUDENT_EMAIL = SM.STUDENT_EMAIL
			AND         A.ARTICLE_TYPE_ID = AT.ARTICLE_TYPE_ID
			AND         A.BOARD_ID = ?
			AND         A.MAJOR_GROUP_ID = 1
			ORDER		BY	A.ARTICLE_ID DESC
		</showMajorArticle>

		<showUnivArticle>
			SELECT		ARTICLE_ID
						, ARTICLE_TITLE
						, ARTICLE_DESC
						, ARTICLE_MODIFY_DATE
						, AT.ARTICLE_TYPE_NAME
						, SM.NICK_NAME
						, BOARD_ID
						, A.UNIV_ID
						, HITS
						, ARTICLE_LIKES
						, ARTICLE_DISLIKES
			FROM 		ARTICLE A
						, STD_MEMBER SM
						, ARTICLE_TYPE AT
			WHERE	    A.STUDENT_EMAIL = SM.STUDENT_EMAIL
			AND         A.ARTICLE_TYPE_ID = AT.ARTICLE_TYPE_ID
			AND         A.BOARD_ID = ?
			AND         A.UNIV_ID = 1
			ORDER		BY	A.ARTICLE_ID DESC
		</showUnivArticle>

		
		<showSecretArticle>
        	SELECT		ARTICLE_ID
        				, ARTICLE_TITLE
						, ARTICLE_DESC
						, ARTICLE_MODIFY_DATE
						, AT.ARTICLE_TYPE_NAME
						, SM.NICK_NAME
						, BOARD_ID
						, A.MAJOR_GROUP_ID
						, HITS
						, ARTICLE_LIKES
			FROM 		ARTICLE A
						, STD_MEMBER SM
						, ARTICLE_TYPE AT
			WHERE	    A.STUDENT_EMAIL = SM.STUDENT_EMAIL
			AND         A.ARTICLE_TYPE_ID = AT.ARTICLE_TYPE_ID
			AND         A.BOARD_ID = 4
			AND         A.MAJOR_GROUP_ID = 20
			ORDER		BY	A.ARTICLE_ID DESC
		</showSecretArticle>
		<doWriteMajorArticle>
			INSERT INTO 	ARTICLE (
  										 ARTICLE_ID
  										 , ARTICLE_TITLE
  										 , ARTICLE_DESC
  										 , ARTICLE_REGISTER_DATE
  										 , ARTICLE_MODIFY_DATE
  										 , ARTICLE_TYPE_ID
  										 , STUDENT_EMAIL
  										 , BOARD_ID
  										 , MAJOR_GROUP_ID
  									)	 
			VALUES 					( 
										ARTICLE_ID_SEQ.NEXTVAL
										, ?
										, ?
										, SYSDATE
										, SYSDATE
										, ?
										, ?
										, ?
										, ?
									)
		</doWriteMajorArticle>
		<doWriteUnivArticle>
			INSERT INTO 	ARTICLE (
  										 ARTICLE_ID
  										 , ARTICLE_TITLE
  										 , ARTICLE_DESC
  										 , ARTICLE_REGISTER_DATE
  										 , ARTICLE_MODIFY_DATE
  										 , ARTICLE_TYPE_ID
  										 , STUDENT_EMAIL
  										 , BOARD_ID
  										 , UNIV_ID
  									)	 
			VALUES 					( 
										ARTICLE_ID_SEQ.NEXTVAL
										, ?
										, ?
										, SYSDATE
										, SYSDATE
										, ?
										, ?
										, ?
										, ?
									)
		</doWriteUnivArticle>
		<hitsCount>
			UPDATE	ARTICLE
			SET		HITS = HITS + 1
			WHERE	ARTICLE_ID = ?
		</hitsCount>
		
		
		
		<showMyWriteArticle>
			SELECT	ARTICLE_ID
        				, ARTICLE_TITLE
						, ARTICLE_DESC
						, ARTICLE_MODIFY_DATE
						, AT.ARTICLE_TYPE_NAME
						, SM.NICK_NAME
						, BOARD_ID
						, A.MAJOR_GROUP_ID
						, HITS
						, ARTICLE_LIKES
			FROM	ARTICLE A
                    , STD_MEMBER SM
                    , ARTICLE_TYPE AT
			WHERE	A.STUDENT_EMAIL = SM.STUDENT_EMAIL
			AND     A.ARTICLE_TYPE_ID = AT.ARTICLE_TYPE_ID
			AND     BOARD_ID IN (1, 2)
			AND		A.STUDENT_EMAIL = ?
		</showMyWriteArticle>
		
		<showLikesArticle>
			SELECT	AL.ARTICLE_ID
        				, ARTICLE_TITLE
						, ARTICLE_DESC
						, ARTICLE_MODIFY_DATE
						, AT.ARTICLE_TYPE_NAME
						, SM.NICK_NAME
						, AL.BOARD_ID
						, A.MAJOR_GROUP_ID
						, HITS
						, ARTICLE_LIKES
			FROM	ARTICLE A
					, STD_MEMBER SM
					, ARTICLE_LIKE AL 
					, ARTICLE_TYPE AT
			WHERE	A.ARTICLE_ID = AL.ARTICLE_ID
			AND		A.STUDENT_EMAIL = SM.STUDENT_EMAIL
			AND     A.ARTICLE_TYPE_ID = AT.ARTICLE_TYPE_ID
			AND 	AL.STUDENT_EMAIL = ?
		</showLikesArticle>
		
		<showMyScrabArticle>
			SELECT	AB.ARTICLE_ID
        				, ARTICLE_TITLE
						, ARTICLE_DESC
						, ARTICLE_MODIFY_DATE
						, AT.ARTICLE_TYPE_NAME
						, SM.NICK_NAME
						, AB.BOARD_ID
						, A.MAJOR_GROUP_ID
						, HITS
						, ARTICLE_LIKES
			FROM	ARTICLE A
					, STD_MEMBER SM
					, ARTICLE_SCRAB AB
					, ARTICLE_TYPE AT
			WHERE	A.ARTICLE_ID = AB.ARTICLE_ID
			AND		A.STUDENT_EMAIL = SM.STUDENT_EMAIL
			AND     A.ARTICLE_TYPE_ID = AT.ARTICLE_TYPE_ID
			AND		AB.STUDENT_EMAIL = ?
		</showMyScrabArticle>
		
		<getArticleId>
			SELECT ARTICLE_ID
			FROM    ARTICLE
			WHERE   ROWNUM = 1
			ORDER   BY ARTICLE_ID DESC
		</getArticleId>
		<showDetail>
			SELECT		ARTICLE_ID
        				, ARTICLE_TITLE
						, ARTICLE_DESC
						, ARTICLE_MODIFY_DATE
						, AT.ARTICLE_TYPE_NAME
						, SM.NICK_NAME
						, BOARD_ID
						, A.MAJOR_GROUP_ID
						, A.UNIV_ID
						, HITS
						, ARTICLE_LIKES
			FROM 		ARTICLE A
						, STD_MEMBER SM
						, ARTICLE_TYPE AT
			WHERE	    A.STUDENT_EMAIL = SM.STUDENT_EMAIL
			AND         A.ARTICLE_TYPE_ID = AT.ARTICLE_TYPE_ID
			AND         A.ARTICLE_ID = ?
		</showDetail>
	</article>
	<articleLikes>
		<showMajorArticleLike>
			SELECT 		ARTICLE_LIKE_ID
						, ARTICLE_ID
						, STUDENT_EMAIL
						, LIKE_DATE
						, BOARD_ID
			FROM 		ARTICLE_LIKE
			WHERE		STUDENT_EMAIL = ?
			AND			BOARD_ID = ?
		</showMajorArticleLike>
		<selectLikeCount>
			SELECT	COUNT(ARTICLE_LIKE_ID)
			FROM	ARTICLE_LIKE
			WHERE	ARTICLE_ID = ?
			AND		STUDENT_EMAIL = ?
		</selectLikeCount>
		<deleteLike>
			DELETE
			FROM	ARTICLE_LIKE
			WHERE	ARTICLE_ID = ?
			AND		STUDENT_EMAIL = ?
		</deleteLike>
		<insertLike>
			INSERT INTO			ARTICLE_LIKE (
   										ARTICLE_LIKE_ID
   										, ARTICLE_ID
   										, STUDENT_EMAIL
   										, LIKE_DATE
   										, BOARD_ID
   									) 
			VALUES 					( 
										ARTICLE_LIKE_ID_SEQ.NEXTVAL
										, ?
										, ?
										, SYSDATE
										, ?
									)
		</insertLike>
	</articleLikes>

	<stdMember>
		<addStdMember>
			INSERT INTO MEMBER (
									   EMAIL_ID
									   , UNIV_ID
									   , MAJOR_ID
									   , SIGNUP_DATE
									   , SECOND_EMAIL
									   , RANK_MODIFY_DATE
									   , PASSWORD
									   , MAJOR_GROUP_ID
								) 
			VALUES 				( 
										?
										, ?
										, ?
										, SYSDATE
									 	, ?
										, SYSDATE
										, ?
										, ?
								)
		</addStdMember>
		
		<updateMemberInfo>
			UPDATE	STD_MEMBER
			SET		SECOND_EMAIL = ?
					, NICK_NAME = ?
			WHERE	STUDENT_EMAIL = ?
		</updateMemberInfo>
		
		<updateMemberPassword>
			UPDATE	STD_MEMBER
			SET		PASSWORD = ?
			WHERE	STUDENT_EMAIL = ?
		</updateMemberPassword>
		
	</stdMember>
	
	<compMember>
		<addCompMember>
			INSERT INTO MEMBER (
									   EMAIL_ID
									   , MEMBER_TYPE_ID
									   , SIGNUP_DATE
									   , SECOND_EMAIL
									   , RANK_MODIFY_DATE
									   , PASSWORD
									   , PHONE_NUMBER
									   , COMPANY_NAME
								) 
			VALUES 				( 
										?
										, ?
										, SYSDATE
									 	, ?
										, SYSDATE
										, ?
										, ?
										, ?
								)
		</addCompMember>
	</compMember>
	<qa>
	
		<registerQuestionByStudent>
			INSERT INTO CURTAIN.QA	(
										QUESTION_ID
										, QUESTION_TITLE
										, QUESTION_DESCRIPTION
										, ANSWER_DESCRIPTION
										, QUESTION_DATE
										, ANSWER_DATE
										, STUDENT_EMAIL
										, IS_CHECKED
										, COMPANY_EMAIL
									) 
			VALUES					(
										QUESTION_ID_SEQ.NEXTVAL
										, ?
										, ?
										, ''
										, SYSDATE
										, ''
										, ?
										, 'N'
										, ''
									)
		</registerQuestionByStudent>
		
		<registerQuestionByCompany>
			INSERT INTO CURTAIN.QA	(
										QUESTION_ID
										, QUESTION_TITLE
										, QUESTION_DESCRIPTION
										, ANSWER_DESCRIPTION
										, QUESTION_DATE
										, ANSWER_DATE
										, STUDENT_EMAIL
										, IS_CHECKED
										, COMPANY_EMAIL
									) 
			VALUES					(
										QUESTION_ID_SEQ.NEXTVAL
										, ?
										, ?
										, ''
										, SYSDATE
										, ''
										, ''
										, 'N'
										, ?
									)
		</registerQuestionByCompany>
		
		<getMyQuestionsByStudentEmail>
			SELECT	QUESTION_TITLE
					, QUESTION_DESCRIPTION
					, ANSWER_DESCRIPTION
					, QUESTION_DATE
					, ANSWER_DATE
					, IS_CHECKED
			FROM	CURTAIN.QA
			WHERE	STUDENT_EMAIL = ?
		</getMyQuestionsByStudentEmail>
	</qa>
	
	<file>
		<insertOneFile>
					INSERT INTO FILES (
                       FILE_ID
                       , ARTICLE_ID
                       , FILE_NAME
                       , FILE_LOCATION
                       ) 
			VALUES ( 
					FILE_ID_SEQ.NEXTVAL
			         , ?
			         , ?
			         , ?       
			       )
		</insertOneFile>
	</file>
</query>