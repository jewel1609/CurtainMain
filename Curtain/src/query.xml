<?xml version="1.0" encoding="UTF-8"?>

<query>
	<major>
		<getMajorGroupIdByMajorId>
			SELECT	MAJOR_GROUP_ID		
			FROM	MAJOR
			WHERE	MAJOR_ID = ?		
		</getMajorGroupIdByMajorId>
		<getMajorIdByMajorName>
			SELECT	MAJOR_ID		
			FROM	MAJOR
			WHERE	MAJOR_NAME = ? 
		</getMajorIdByMajorName>
		<checkMajorName>
			SELECT	MAJOR_ID
					, MAJOR_NAME
					, MAJOR_GROUP_ID					
			FROM	MAJOR
			WHERE	MAJOR_NAME LIKE '%' || ? || '%'		
		</checkMajorName>
	</major>
	<univ>
		<isExistStdUnivEmail>
			SELECT 	STUDENT_EMAIL
			FROM	STD_MEMBER
			WHERE	STUDENT_EMAIL = ?
		</isExistStdUnivEmail>
		<getUnivIdByUnivName>
			SELECT	UNIV_ID		
			FROM	UNIV
			WHERE	UNIV_NAME = ? 
		</getUnivIdByUnivName>
		<checkUnivName>
			SELECT	UNIV_ID
					, UNIV_NAME
			FROM	UNIV
			WHERE	UNIV_NAME LIKE '%' || ? || '%'			
		</checkUnivName>
	</univ>
	<mac>
		<getMacDescByStudentEmail>
			SELECT 	MAC_ID
					, STUDENT_EMAIL
					, MAC_DESC
			FROM	MAC
			WHERE	STUDENT_EMAIL = ?					
		</getMacDescByStudentEmail>
		
		<addMacInfo>
			INSERT INTO MAC (
						  		MAC_ID
						  		, STUDENT_EMAIL
						  		, MAC_DESC
						  	) 
			VALUES 			( 
								MAC_ID_SEQ.NEXTVAL
								,?
								,? 
							)
		</addMacInfo>
	</mac>
	<article>
		<showMajorArticle>
        	SELECT		ARTICLE_TITLE
						, ARTICLE_DESC
						, ARTICLE_MODIFY_DATE
						, AT.ARTICLE_TYPE_NAME
						, SM.NICK_NAME
						, BOARD_ID
						, A.MAJOR_GROUP_ID
						, HITS
						, ARTICLE_LIKES
			FROM 		ARTICLE A
						, STD_MEMBER SM
						, ARTICLE_TYPE AT
			WHERE	    A.STUDENT_EMAIL = SM.STUDENT_EMAIL
			AND         A.ARTICLE_TYPE_ID = AT.ARTICLE_TYPE_ID
			AND         A.BOARD_ID = 1
			AND         A.MAJOR_GROUP_ID = 1
			ORDER		BY	A.ARTICLE_ID DESC
		</showMajorArticle>
		
		<showSecretArticle>
        	SELECT		ARTICLE_TITLE
						, ARTICLE_DESC
						, ARTICLE_MODIFY_DATE
						, AT.ARTICLE_TYPE_NAME
						, SM.NICK_NAME
						, BOARD_ID
						, A.MAJOR_GROUP_ID
						, HITS
						, ARTICLE_LIKES
			FROM 		ARTICLE A
						, STD_MEMBER SM
						, ARTICLE_TYPE AT
			WHERE	    A.STUDENT_EMAIL = SM.STUDENT_EMAIL
			AND         A.ARTICLE_TYPE_ID = AT.ARTICLE_TYPE_ID
			AND         A.BOARD_ID = 4
			AND         A.MAJOR_GROUP_ID = 20
			ORDER		BY	A.ARTICLE_ID DESC
		</showSecretArticle>
		
		<doWriteMajorArticle>
			INSERT INTO 	ARTICLE (
  										 ARTICLE_ID
  										 , ARTICLE_TITLE
  										 , ARTICLE_DESC
  										 , ARTICLE_REGISTER_DATE
  										 , ARTICLE_MODIFY_DATE
  										 , ARTICLE_TYPE_ID
  										 , STUDENT_EMAIL
  										 , BOARD_ID
  										 , MAJOR_GROUP_ID
  									)	 
			VALUES 					( 
										ARTICLE_ID_SEQ.NEXTVAL
										, ?
										, ?
										, SYSDATE
										, SYSDATE
										, ?
										, ?
										, ?
										, ?
									)
		</doWriteMajorArticle>
		
		
		
		
		<myWriteArticle>
			SELECT	ARTICLE_TITLE
					, ARTICLE_DESC
					, ARTICLE_MODIFY_DATE
					, BOARD_ID
					, SM.NICK_NAME
					, A.MAJOR_GROUP_ID
					, HITS
					, ARTICLE_LIKES
			FROM	ARTICLE A
                    , STD_MEMBER SM
			WHERE	A.STUDENT_EMAIL = SM.STUDENT_EMAIL
			AND     BOARD_ID IN (1, 2)
			AND		A.STUDENT_EMAIL = ?
		</myWriteArticle>
		
		<showLikesArticle>
			SELECT	ARTICLE_TITLE
					, ARTICLE_DESC
					, ARTICLE_MODIFY_DATE
					, BOARD_ID
					, SM.NICK_NAME
					, A.MAJOR_GROUP_ID
					, HITS
					, ARTICLE_LIKES
			FROM	ARTICLE A
					, STD_MEMBER SM
					, ARTICLE_LIKE AL 
			WHERE	A.STUDENT_EMAIL = ?
			AND		A.ARTICLE_ID = AL.ARTICLE_ID
		</showLikesArticle>
		
		<myScrabArticle>
			SELECT	ARTICLE_TITLE
					, ARTICLE_DESC
					, ARTICLE_MODIFY_DATE
					, BOARD_ID
					, SM.NICK_NAME
					, A.MAJOR_GROUP_ID
					, HITS
					, ARTICLE_LIKES
			FROM	ARTICLE A
					, STD_MEMBER SM
					, ARTICLE_SCRAB AB
			WHERE	A.STUDENT_EMAIL = ?
			AND		A.ARTICLE_ID = AB.ARTICLE_ID
		</myScrabArticle>
		
		<getArticleId>
			SELECT ARTICLE_ID
			FROM    ARTICLE
			WHERE   ROWNUM = 1
			ORDER   BY ARTICLE_ID DESC
		</getArticleId>
	</article>

	<stdMember>
		<addStdMember>
			INSERT INTO STD_MEMBER (
										   STUDENT_EMAIL
										   , UNIV_ID
										   , MAJOR_ID
										   , SIGNUP_DATE
										   , SECOND_EMAIL
										   , RANK_MODIFY_DATE
										   , PASSWORD
										   , MAJOR_GROUP_ID
									) 
			VALUES 					( 
											?
											, ?
											, ?
											, SYSDATE
										 	, ?
											, SYSDATE
											, ?
											, ?
									)
		</addStdMember>
		
		<updateMemberInfo>
			UPDATE	STD_MEMBER
			SET		SECOND_EMAIL = ?
					, NICK_NAME = ?
			WHERE	STUDENT_EMAIL = ?
		</updateMemberInfo>
		
		<updateMemberPassword>
			UPDATE	STD_MEMBER
			SET		PASSWORD = ?
			WHERE	STUDENT_EMAIL = ?
		</updateMemberPassword>
		
	</stdMember>
	
	<qa>
	
		<registerQuestionByStudent>
			INSERT INTO CURTAIN.QA	(
										QUESTION_ID
										, QUESTION_TITLE
										, QUESTION_DESCRIPTION
										, ANSWER_DESCRIPTION
										, QUESTION_DATE
										, ANSWER_DATE
										, STUDENT_EMAIL
										, IS_CHECKED
										, COMPANY_EMAIL
									) 
			VALUES					(
										QUESTION_ID_SEQ.NEXTVAL
										, ?
										, ?
										, ''
										, SYSDATE
										, ''
										, ?
										, 'N'
										, ''
									)
		</registerQuestionByStudent>
		
		<registerQuestionByCompany>
			INSERT INTO CURTAIN.QA	(
										QUESTION_ID
										, QUESTION_TITLE
										, QUESTION_DESCRIPTION
										, ANSWER_DESCRIPTION
										, QUESTION_DATE
										, ANSWER_DATE
										, STUDENT_EMAIL
										, IS_CHECKED
										, COMPANY_EMAIL
									) 
			VALUES					(
										QUESTION_ID_SEQ.NEXTVAL
										, ?
										, ?
										, ''
										, SYSDATE
										, ''
										, ''
										, 'N'
										, ?
									)
		</registerQuestionByCompany>
		
		<getMyQuestionsByStudentEmail>
			SELECT	QUESTION_TITLE
					, QUESTION_DESCRIPTION
					, ANSWER_DESCRIPTION
					, QUESTION_DATE
					, ANSWER_DATE
					, IS_CHECKED
			FROM	CURTAIN.QA
			WHERE	STUDENT_EMAIL = ?
		</getMyQuestionsByStudentEmail>
	</qa>
	
	<file>
		<insertOneFile>
					INSERT INTO FILES (
                       FILE_ID
                       , ARTICLE_ID
                       , FILE_NAME
                       , FILE_LOCATION
                       ) 
			VALUES ( 
					FILE_ID_SEQ.NEXTVAL
			         , ?
			         , ?
			         , ?       
			       )
		</insertOneFile>
	</file>
</query>